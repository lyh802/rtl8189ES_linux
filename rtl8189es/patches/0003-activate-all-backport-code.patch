From 097f3f9719d4b976e7b985f41228acd76f670608 Mon Sep 17 00:00:00 2001
From: Hauke Mehrtens <hauke@hauke-m.de>
Date: Wed, 27 Sep 2017 23:38:49 +0200
Subject: [PATCH] activate all backport code

Signed-off-by: lyh802 <lyh802@126.com>
---
 os_dep/linux/ioctl_cfg80211.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/os_dep/linux/ioctl_cfg80211.c b/os_dep/linux/ioctl_cfg80211.c
index d6c2f2f..2f9b888 100644
--- a/os_dep/linux/ioctl_cfg80211.c
+++ b/os_dep/linux/ioctl_cfg80211.c
@@ -7585,7 +7585,7 @@ static void cfg80211_rtw_mgmt_frame_register(struct wiphy *wiphy,
 #else
 	struct net_device *ndev,
 #endif
-#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0))
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0)) || defined(BUILD_OPENWRT)
 	struct mgmt_frame_regs *upd)
 #else
 	u16 frame_type, bool reg)
@@ -7605,7 +7605,7 @@ static void cfg80211_rtw_mgmt_frame_register(struct wiphy *wiphy,
 	pwdev_priv = adapter_wdev_data(adapter);
 
 #ifdef CONFIG_DEBUG_CFG80211
-#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0))
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0)) || defined(BUILD_OPENWRT)
 	RTW_INFO(FUNC_ADPT_FMT" old_regs:%x, new_regs:%x\n", FUNC_ADPT_ARG(adapter),
 		pwdev_priv->report_mgmt, upd->interface_stypes);
 #else
@@ -7614,7 +7614,7 @@ static void cfg80211_rtw_mgmt_frame_register(struct wiphy *wiphy,
 #endif
 #endif
 
-#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0))
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0)) || defined(BUILD_OPENWRT)
 	pwdev_priv->report_mgmt = upd->interface_stypes & (
 #ifdef not_yet
 		BIT(IEEE80211_STYPE_PROBE_REQ >> 4) |
@@ -10029,7 +10029,7 @@ static struct cfg80211_ops rtw_cfg80211_ops = {
 
 #if (LINUX_VERSION_CODE >= KERNEL_VERSION(2, 6, 37)) || defined(COMPAT_KERNEL_RELEASE)
 	.mgmt_tx = cfg80211_rtw_mgmt_tx,
-	#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0))
+	#if (LINUX_VERSION_CODE >= KERNEL_VERSION(5, 8, 0)) || defined(BUILD_OPENWRT)
 	.update_mgmt_frame_registrations = cfg80211_rtw_mgmt_frame_register,
 	#else
 	.mgmt_frame_register = cfg80211_rtw_mgmt_frame_register,
-- 
2.13.1.windows.1

